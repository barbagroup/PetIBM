<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PetIBM: Input files</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PetIBM<span id="projectnumber">&#160;0.5.4</span>
   </div>
   <div id="projectbrief">Toolbox and applications of the immersed-boundary method for distributed-memory architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d1/dee/md_doc_markdowns_inputs.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Input files </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >PetIBM reads input parameters from a <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file (typically called <code>config.yaml</code>) that is located in the simulation directory (i.e. directory where the numerical solution will be written).</p>
<p >If the current working directory is not the simulation directory, the user should provide the command-line argument <code>-directory &lt;simulation-directory&gt;</code>.</p>
<p >If the configuration file is located in another directory, the user should provide the path of the file using the command-line argument <code>-config &lt;file-path&gt;</code>. (The path can be absolute or relative to the current working directory.)</p>
<hr  />
<h1>Basic <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file</h1>
<p >A basic <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file for a 2D run will look like:</p>
<div class="fragment"><div class="line">mesh:</div>
<div class="line">  - direction: x</div>
<div class="line">    start: 0.0</div>
<div class="line">    subDomains:</div>
<div class="line">      - end: 1.0</div>
<div class="line">        cells: 32</div>
<div class="line">        stretchRatio: 1.0</div>
<div class="line">  - direction: y</div>
<div class="line">    start: 0.0</div>
<div class="line">    subDomains:</div>
<div class="line">      - end: 1.0</div>
<div class="line">        cells: 32</div>
<div class="line">        stretchRatio: 1.0</div>
<div class="line"> </div>
<div class="line">flow:</div>
<div class="line">    nu: 0.01</div>
<div class="line">    initialVelocity: [0.0, 0.0]</div>
<div class="line">    boundaryConditions:</div>
<div class="line">      - location: xMinus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">      - location: xPlus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">      - location: yMinus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">      - location: yPlus</div>
<div class="line">        u: [DIRICHLET, 1.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line"> </div>
<div class="line">parameters:</div>
<div class="line">    dt: 0.01</div>
<div class="line">    startStep: 0</div>
<div class="line">    nt: 1000</div>
<div class="line">    nsave: 1000</div>
<div class="line">    nrestart: 1000</div>
<div class="line">    convection: ADAMS_BASHFORTH_2</div>
<div class="line">    diffusion: CRANK_NICOLSON</div>
<div class="line">    velocitySolver:</div>
<div class="line">      type: CPU</div>
<div class="line">      config: solversPetscOptions.info</div>
<div class="line">    poissonSolver:</div>
<div class="line">      type: CPU</div>
<div class="line">      config: solversPetscOptions.info</div>
<div class="line"> </div>
<div class="line">bodies:</div>
<div class="line">  - type: points</div>
<div class="line">    file: circle.body</div>
<div class="line"> </div>
<div class="line">probes:</div>
<div class="line">  - name: probe-u1</div>
<div class="line">    viewer: ascii</div>
<div class="line">    field: u</div>
<div class="line">    nsave: 1</div>
<div class="line">    path: solution/probe-u1.dat</div>
<div class="line">    box:</div>
<div class="line">      x: [0.59, 0.61]</div>
<div class="line">      y: [-0.01, 0.01]</div>
</div><!-- fragment --><p >The configuration contains three mandatory nodes: <code>mesh</code>, <code>flow</code>, <code>parameters</code>. The node <code>bodies</code> is required when running a simulation with at least one boundary immersed in the computational domain. The node <code>probes</code> can be used to monitor a specific scalar field variable (velocity components or pressure) in a specific subregion of the computational domain.</p>
<hr  />
<h1><a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>mesh</code></h1>
<p ><code>mesh</code> controls the parameters of the structured Cartesian grid to be created. We need to provide sufficient information to generate the gridline coordinates in the <code>direction</code> <code>x</code>, <code>y</code>, and <code>z</code>. (For 2D runs, the <code>z</code> direction should be omitted.)</p>
<p >A gridline is defined by the location of a starting point (<code>start</code>), which corresponds to the minimum value along the gridline (for example, location of the left boundary in the x-direction).</p>
<p >A gridline is divided into consecutive sub-domains (<code>subDomains</code>), each one being defined with the coordinate of a ending point (<code>end</code>), a number of cells (<code>cells</code>), and optionally a stretching ratio (<code>stretchRatio</code>). The stretching ratio represents the ratio between the width of two consecutive cells. (A ratio greater than <code>1.0</code> means that the cell width increases along the gridline in the positive direction.)</p>
<p >Based on those information, PetIBM computes the cell widths and the user should make sure that the cells at the interface between two sub-domains are approximately of equal size.</p>
<p >Example:</p>
<p >The following node will generate a 2D structured Cartesian grid with 1704 cells in the x and y directions in the domain [-15, 15]x[-15, 15] where the mesh is uniform in the sub-domain [-0.52, 1.48]x[-2, 2] and stretched to the external boundaries with a constant ratio of 1.01.</p>
<div class="fragment"><div class="line">mesh:</div>
<div class="line">  - direction: x</div>
<div class="line">    start: -15.0</div>
<div class="line">    subDomains:</div>
<div class="line">      - cells: 363</div>
<div class="line">        end: -0.52</div>
<div class="line">        stretchRatio: 0.9900990099009901</div>
<div class="line">      - cells: 1000</div>
<div class="line">        end: 3.48</div>
<div class="line">        stretchRatio: 1.0</div>
<div class="line">      - cells: 341</div>
<div class="line">        end: 15.0</div>
<div class="line">        stretchRatio: 1.01</div>
<div class="line">  - direction: y</div>
<div class="line">    start: -15.0</div>
<div class="line">    subDomains:</div>
<div class="line">      - cells: 352</div>
<div class="line">        end: -2.0</div>
<div class="line">        stretchRatio: 0.9900990099009901</div>
<div class="line">      - cells: 1000</div>
<div class="line">        end: 2.0</div>
<div class="line">        stretchRatio: 1.0</div>
<div class="line">      - cells: 352</div>
<div class="line">        end: 15.0</div>
<div class="line">        stretchRatio: 1.01</div>
</div><!-- fragment --><hr  />
<h1><a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>flow</code></h1>
<p ><code>flow</code> prescribed the characteristics of the fluid as well as the initial and boundary conditions of the flow velocity.</p>
<p ><code>nu</code> is the kinematic viscosity of the fluid.</p>
<p ><code>initialVelocity</code> describes the initial velocity vector field. It is a list of length equal to the flow's dimension. The first element in the list denotes the initial value/function for u-velocity, while the second element denotes the v-velocity. The third element, if it exists, is for the w-velocity. There are two types of legal values in the list:</p>
<ol type="1">
<li>A floating point number. A velocity field will be initialized as an uniform field with the given value.</li>
<li>A string of symbolic math expression, for example <code>"cos(2*pi*x) * sin(2*pi*y)"</code>. We use <a href="https://github.com/symengine/symengine"><code>SymEngine</code></a> to parse symbolic expressions. So only the math operations and math functions available in SymEngine are allowed here. SymEngine is the backend of the well-known python library <code>SymPy</code>, so <code>SymPy</code>'s documentation may be a good start point to know what operations and functions are available. For the independent variables, only <code>x</code>, <code>y</code>, <code>z</code>, <code>t</code>, and <code>nu</code> are allowed. The case at <code>examples/navierstokes/taylorgreenvortex</code> provides a example of using symbolic expression for initialization.</li>
</ol>
<p ><code>initialPressure</code> is an optional parameter and needs a single value if present in the configuration. Similar to <code>initialVelocity</code>, the value can be a floating point number or a symbolic expression string. If <code>initialPressure</code> is absent, the pressure filed will be initialized with zero.</p>
<p ><code>boundaryConditions</code> lists the type and value of a velocity component (<code>u</code>, <code>v</code>, or <code>w</code>) for all boundaries. The boundary locations are: <code>xMinus</code> and <code>xPlus</code> for the left and right, <code>yMinus</code> and <code>yPlus</code> for the bottom and top, and <code>zMinus</code> and <code>zPlus</code> for the front and back boundaries. (<code>zMinus</code> and <code>zPLus</code> should be omitted for 2D runs.) PetIBM implements different type of boundary conditions:</p>
<ul>
<li>Dirichlet (<code>DIRICHLET</code>); the value corresponds the value of the velocity component at the boundary;</li>
<li>Neumman (<code>NEUMANN</code>); the value represents the value of the derivative normal to the boundary of the velocity component;</li>
<li>convective (<code>CONVECTIVE</code>); the value is the speed at which the velocity component is convected;</li>
<li>periodic (<code>PERIODIC</code>); the value has no meaning and can be set to whatever number.</li>
</ul>
<p >The following node corresponds to flow characteristics for a 3D cavity flow (initially at rest) at Reynolds number 500 (based on the kinematic viscosity, the length of the cavity, and the speed of the lid-driven wall) with a lid-driven wall at the top boundary (moving with speed 1 in the x direction) and with periodic boundary conditions in the z direction.</p>
<div class="fragment"><div class="line">flow:</div>
<div class="line">    nu: 0.002</div>
<div class="line">    initialVelocity: [0.0, 0.0, 0.0]</div>
<div class="line">    boundaryConditions:</div>
<div class="line">      - location: xMinus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">        w: [DIRICHLET, 0.0]</div>
<div class="line">      - location: xPlus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">        w: [DIRICHLET, 0.0]</div>
<div class="line">      - location: yMinus</div>
<div class="line">        u: [DIRICHLET, 0.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">        w: [DIRICHLET, 0.0]</div>
<div class="line">      - location: yPlus</div>
<div class="line">        u: [DIRICHLET, 1.0]</div>
<div class="line">        v: [DIRICHLET, 0.0]</div>
<div class="line">        w: [DIRICHLET, 0.0]</div>
<div class="line">      - location: zMinus</div>
<div class="line">        u: [PERIODIC, 0.0]</div>
<div class="line">        v: [PERIODIC, 0.0]</div>
<div class="line">        w: [PERIODIC, 0.0]</div>
<div class="line">      - location: zPlus</div>
<div class="line">        u: [PERIODIC, 0.0]</div>
<div class="line">        v: [PERIODIC, 0.0]</div>
<div class="line">        w: [PERIODIC, 0.0]</div>
</div><!-- fragment --><hr  />
<h1><a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>parameters</code></h1>
<p >This node gather various <code>parameters</code> regarding the advancement of a simulation.</p>
<ul>
<li><code>dt</code>: the time-step size.</li>
<li><code>startStep</code>: index of the stating time step (default is zero).</li>
<li><code>nt</code>: number of time steps to compute.</li>
<li><code>nsave</code>: frequency (in number of time steps) of saving for the numerical solution.</li>
<li><code>nrestart</code>: frequency (in number of time steps) of saving for the convective and diffusive terms; those terms will required upon restart of a run at a time step different from 0.</li>
<li><code>convection</code>: time scheme for the convective terms; choices are the default explicit Euler method (<code>EULER_EXPLICIT</code>) or an explicit second-order Adams-Bashforth scheme (<code>ADAMS_BASHFORTH_2</code>).</li>
<li><code>diffusion</code>: time scheme for the diffusive terms; choices are the default implicit Euler method (<code>EULER_IMPLICIT</code>), an explicit Euler method (<code>EULER_EXPLICIT</code>), or a second-order Crank-Nicolson scheme (<code>CRANK_NICOLSON</code>).</li>
<li><code>BN</code>: order of the truncated Taylor series expansion of the implicit matrix <code>A</code> (where <code>A</code> is the left-hand side operator of the system for the intermediate velocity vector). The default value is <code>1</code>, which leads to the identity operator scaled by the time-step size.</li>
<li><code>delta</code>: regularized delta function to use; choices are <code>ROMA_ET_AL_1999</code> (3-point kernel) and <code>PESKIN_2002</code> (4-point kernel).</li>
<li><code>velocitySolver</code>, <code>poissonSolver</code>, and <code>forcesSolver</code> (for the decoupled version of the immersed-boundary projection method) each references the type of hardware used to solve the linear system (either <code>CPU</code> or <code>GPU</code>) and the path (relative to the <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file) of the file containing the parameters for the linear solver.</li>
</ul>
<p >In the following example, PetIBM will run 1000 time steps (from time step 0) with a time increment of 0.01, saving the numerical solution (velocity vector field, pressure scalar field, and Lagrangian boundary forces) every 100 time steps and saving the convective and diffusive terms every 200 time steps.</p>
<div class="fragment"><div class="line">parameters:</div>
<div class="line">    dt: 0.01</div>
<div class="line">    startStep: 0</div>
<div class="line">    nt: 1000</div>
<div class="line">    nsave: 100</div>
<div class="line">    nrestart: 200</div>
<div class="line">    convection: ADAMS_BASHFORTH_2</div>
<div class="line">    diffusion: CRANK_NICOLSON</div>
<div class="line">    BN: 1</div>
<div class="line">    velocitySolver:</div>
<div class="line">      type: CPU</div>
<div class="line">      config: solversPetscOptions.info</div>
<div class="line">    poissonSolver:</div>
<div class="line">      type: GPU</div>
<div class="line">      config: solversAmgXOptions.info</div>
</div><!-- fragment --><p >In the example above, the velocity system will be solved on CPU with PETSc KSP and the parameters of the linear solver can be prescribed in the file <code>solversPetscOptions.info</code>. (The PETSc prefix for the arguments is <code>-velocity_</code>, <code>-poisson_</code>, and <code>-forces_</code> for the velocity system, the Poisson system, and the Lagrangian forces system, respectively.)</p>
<p >The Poisson system will be solved on GPU devices with the <a href="https://github.com/NVIDIA/AMGX">NVIDIA AmgX library</a> and the parameters of the linear solver are prescribed in the file <code>solversAmgXOptions.info</code>.</p>
<hr  />
<h1><a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>bodies</code></h1>
<p ><code>bodies</code> provides information about the boundaries immersed in the computational domain.</p>
<p >For example, the following node stipulates that there are two immersed boundaries defined by <code>points</code> coordinates that can be read in the ASCII files <code>boundary1.txt</code> and <code>boundary2.txt</code>, respectively. (The path of the files can be either absolute or relative to the simulation directory.)</p>
<div class="fragment"><div class="line">bodies:</div>
<div class="line">  - type: points</div>
<div class="line">    file: boundary1.txt</div>
<div class="line">  - type: points</div>
<div class="line">    file: boundary2.txt</div>
</div><!-- fragment --><p >The file <code>boundary1.txt</code> contains the coordinates of the first boundary with the first line storing the number of points. The other lines contain the coordinates of points describing the boundary (2 columns for 2D simulations, 3 columns for 3D simulations).</p>
<p >Example of a 2D boundary with 4 points: </p><div class="fragment"><div class="line">4</div>
<div class="line">0.0    0.0</div>
<div class="line">1.0    0.0</div>
<div class="line">1.0    1.0</div>
<div class="line">0.0    1.0</div>
</div><!-- fragment --><hr  />
<h1><a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>probes</code></h1>
<p >The <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> node <code>probes</code> contains a sequence of probes. A probe can be used to monitor a scalar field variable (e.g., a velocity component or the pressure) either in a sub-volume of the domain or at a single point.</p>
<p >General configuration of a probe:</p>
<ul>
<li><code>name</code>: (optional) name of the probe; default name is <code>unnamed</code>.</li>
<li><code>type</code>: (required) type of the probe (<code>VOLUME</code> for to monitor a sub-volume, <code>POINT</code> to interpolate the value a single point).</li>
<li><code>field</code>: (required) name of the scalar field variable (supported variables are <code>p</code> for the pressure, <code>u</code>, <code>v</code>, and <code>w</code> for the velocity components).</li>
<li><code>path</code>: (required) path of the file to write the data (relative to the <code>output</code> directory) into (parent folder needs to exist).</li>
<li><code>n_monitor</code>: (optional) monitoring frequency (as a number of time steps); default value is <code>1</code>.</li>
<li><code>t_start</code>: (optional) time value to start monitoring the variable; default is <code>0.0</code>.</li>
<li><code>t_end</code>: (optional) time value to finish monitoring the variable; default is <code>1e12</code>.</li>
</ul>
<p >Additional configuration for a volume probe:</p>
<ul>
<li><code>box</code>: (required) limits of the box in the <code>x</code>, <code>y</code>, and <code>z</code> directions.</li>
<li><code>viewer</code>: (optional) type of the PETSc Viewer object to use to output the data (choices are <code>ascii</code> and <code>hdf5</code>); default value is <code>ascii</code>.</li>
<li><code>n_sum</code>: (optional) number of time-steps over which the data at accumulated; after <code>n_sum</code> time-steps, the accumulated data are averaged in time and output to file; default is <code>0</code> (i.e., does not accumulate).</li>
</ul>
<p >Additional configuration for a point probe:</p>
<ul>
<li><code>loc</code>: (required) location of the point to monitor (a linear interpolation is performed at that point; bi-linear for two-dimensional runs, tri-linear for three-dimensional runs).</li>
</ul>
<p >In the following example, the computational domain extends from -1 to +1 in the x and y directions and we monitor the solution of the pressure in a sub-volume and the x-component of the velocity at a single point. We monitor the pressure every time step in the subregion <code>[-0.5, 0.0]x[-0.5, 0.0]</code> but accumulate (sum) the data over a period of 100 time steps; the time-averaged data is output to file every 100 time steps into HDF5 format. We monitor the x-component of the velocity every 20 time-steps at the point <code>[0.25, 0.25]</code>; the time-step value is output to an ASCII file every 20 time-steps. In this example, output files for the probes are saved in the <code>solution</code> sub-folder of the simulation directory.</p>
<div class="fragment"><div class="line">probes:</div>
<div class="line">  - name: probe-p</div>
<div class="line">    type: VOLUME</div>
<div class="line">    field: p</div>
<div class="line">    viewer: hdf5</div>
<div class="line">    path: solution/probe-p.dat</div>
<div class="line">    n_monitor: 1</div>
<div class="line">    n_sum: 100</div>
<div class="line">    box:</div>
<div class="line">      x: [-0.5, 0.0]</div>
<div class="line">      y: [-0.5, 0.0]</div>
<div class="line">  - name: probe-u</div>
<div class="line">    type: POINT</div>
<div class="line">    field: u</div>
<div class="line">    path: solution/probe-u.dat</div>
<div class="line">    n_monitor: 20</div>
<div class="line">    loc: [0.25, 0.25]</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon May 30 2022 16:28:11 for PetIBM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
