<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PetIBM: Installation</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PetIBM<span id="projectnumber">&#160;0.5.3</span>
   </div>
   <div id="projectbrief">Toolbox and applications of the immersed-boundary method for distributed-memory architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/df1/md_doc_markdowns_installation.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Installation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >For users familiar with Docker or Singularity Container, we provides images for the both systems to save you from compiling, buliding, and installing:</p>
<ul>
<li>Docker: <a href="https://hub.docker.com/repository/docker/barbagroup/petibm">https://hub.docker.com/repository/docker/barbagroup/petibm</a></li>
<li>Singularity: <a href="https://github.com/barbagroup/petibm-recipes/tree/master/singularity">https://github.com/barbagroup/petibm-recipes/tree/master/singularity</a></li>
</ul>
<p >However, if you would like to build PetIBM from source, please continue on this document.</p>
<h1>Dependencies (current PetIBM version)</h1>
<p ><b>Required</b>:</p>
<ul>
<li>GNU C++ compiler g++ (only 11.2 have been tested w/ the latest PetIBM)</li>
<li><a href="https://www.mcs.anl.gov/petsc/">PETSc</a> (3.16+) with HDF5 enabled</li>
<li>MPI: OpenMPI, MPICH, or Intel MPI</li>
<li><a href="https://github.com/jbeder/yaml-cpp">yaml-cpp</a> (0.6.2)</li>
<li><a href="https://github.com/google/googletest">gtest</a> (1.7.0)</li>
</ul>
<p ><b>Optional for GPU linear solvers</b>:</p>
<ul>
<li><a href="https://github.com/NVIDIA/AMGX">AmgX</a> (v2.1.0)</li>
<li><a href="https://github.com/barbagroup/AmgXWrapper">AmgXWrapper</a> (1.5)</li>
</ul>
<p ><b>Optional for pre- and post-processing Python scripts</b>:</p>
<ul>
<li>Python (3.6+)</li>
<li>NumPy (1.12.1)</li>
<li>h5py (2.7.0)</li>
<li>Matplotlib (2.0.2)</li>
</ul>
<p ><b>Note</b>:</p>
<ul>
<li>MPI can be either installed during PETSc configuration or installed explicitly by users.</li>
<li><a href="https://github.com/jbeder/yaml-cpp">yaml-cpp</a>, <a href="https://github.com/google/googletest">gtest</a>, and <a href="https://github.com/barbagroup/AmgXWrapper">AmgXWrapper</a> can be automatically installed during PetIBM configuration or explicitly installed by users in advance.</li>
<li>The current version of PetIBM has been tested with:<ul>
<li>Arch Linux with g++-11.2.0 and PETSc 3.16.5</li>
</ul>
</li>
<li>PetIBM versions prior commit a657821 (or version 0.5.2, included) have been tested with:<ul>
<li>Ubuntu 16.04 with g++-5.4, and PETSc-3.11.2</li>
<li>MacOS Sierra with g++-6.0, and PETSc-3.8.2</li>
<li>Arch Linux with g++-7.2, and PETSc-3.8.2</li>
</ul>
</li>
<li>Older versions of PetIBM have also been tested on the following HPC systems:<ul>
<li><a href="https://colonialone.gwu.edu/">GW ColonialOne</a></li>
<li><a href="https://www.olcf.ornl.gov/titan/">Titan</a> at ORNL</li>
</ul>
</li>
</ul>
<hr  />
<h1>GNU C++ Compiler (<code>g++</code>)</h1>
<p >On Ubuntu, install <code>g++</code> using the following command: </p><pre class="fragment">sudo apt-get install g++
</pre><p> Check the version of G++ installed: </p><pre class="fragment">g++ --version
</pre><p> On Mac OS X, <code>g++</code> can be installed on Mac OS X via XCode or <a href="../../brew.sh">Homebrew</a>.</p>
<hr  />
<h1>PETSc</h1>
<p >PetIBM relies on the data structures and parallel routines of the PETSc library.</p>
<p >Here, we provide the command-line instructions to install PETSc-3.11.3 in debugging mode and/or optimized mode. The debug mode is recommended during development, while the optimized mode should be used for production runs.</p>
<p >Get and unpack PETSc:</p>
<div class="fragment"><div class="line">cd $HOME/sfw</div>
<div class="line">mkdir -p petsc/3.11.3</div>
<div class="line">wget http://ftp.mcs.anl.gov/pub/petsc/release-snapshots/petsc-lite-3.11.3.tar.gz</div>
<div class="line">tar -xvf petsc-lite-3.11.3.tar.gz -C petsc/3.11.3 --strip-components=1</div>
<div class="line">cd petsc/3.11.3</div>
</div><!-- fragment --><p >Configure and build an debugging version of PETSc:</p>
<div class="fragment"><div class="line">export PETSC_DIR=$HOME/sfw/petsc/3.11.3</div>
<div class="line">export PETSC_ARCH=linux-dbg</div>
<div class="line">./configure --PETSC_DIR=$PETSC_DIR --PETSC_ARCH=$PETSC_ARCH \</div>
<div class="line">    --with-cc=gcc \</div>
<div class="line">    --with-cxx=g++ \</div>
<div class="line">    --with-fc=gfortran \</div>
<div class="line">    --COPTFLAGS=&quot;-O0&quot; \</div>
<div class="line">    --CXXOPTFLAGS=&quot;-O0&quot; \</div>
<div class="line">    --FOPTFLAGS=&quot;-O0&quot; \</div>
<div class="line">    --with-debugging=1 \</div>
<div class="line">    --download-fblaslapack \</div>
<div class="line">    --download-openmpi \</div>
<div class="line">    --download-hdf5 \</div>
<div class="line">    --download-hypre \</div>
<div class="line">    --download-ptscotch \</div>
<div class="line">    --download-metis \</div>
<div class="line">    --download-parmetis \</div>
<div class="line">    --download-superlu_dist</div>
<div class="line">make all</div>
<div class="line">make test</div>
</div><!-- fragment --><p >If you do not have a Fortran compiler ready, you use the following configuration:</p>
<div class="fragment"><div class="line">./configure --PETSC_ARCH=$PETSC_ARCH \</div>
<div class="line">    --with-cc=gcc \</div>
<div class="line">    --with-cxx=g++ \</div>
<div class="line">    --COPTFLAGS=&quot;-O0&quot; \</div>
<div class="line">    --CXXOPTFLAGS=&quot;-O0&quot; \</div>
<div class="line">    --with-debugging=1 \</div>
<div class="line">    --download-f2cblaslapack \</div>
<div class="line">    --download-openmpi \</div>
<div class="line">    --download-hdf5 \</div>
<div class="line">    --download-hypre \</div>
<div class="line">    --download-ptscotch \</div>
<div class="line">    --download-metis \</div>
<div class="line">    --download-parmetis \</div>
<div class="line">    --download-superlu_dist</div>
</div><!-- fragment --><p >Configure and build an optimized version of PETSc:</p>
<div class="fragment"><div class="line">export PETSC_DIR=$HOME/sfw/petsc/3.11.3</div>
<div class="line">export PETSC_ARCH=linux-opt</div>
<div class="line">./configure --PETSC_DIR=$PETSC_DIR --PETSC_ARCH=$PETSC_ARCH \</div>
<div class="line">    --with-cc=gcc \</div>
<div class="line">    --with-cxx=g++ \</div>
<div class="line">    --with-fc=gfortran \</div>
<div class="line">    --COPTFLAGS=&quot;-O3&quot; \</div>
<div class="line">    --CXXOPTFLAGS=&quot;-O3&quot; \</div>
<div class="line">    --FOPTFLAGS=&quot;-O3&quot; \</div>
<div class="line">    --with-debugging=0 \</div>
<div class="line">    --download-fblaslapack \</div>
<div class="line">    --download-openmpi \</div>
<div class="line">    --download-hdf5 \</div>
<div class="line">    --download-hypre \</div>
<div class="line">    --download-ptscotch \</div>
<div class="line">    --download-metis \</div>
<div class="line">    --download-parmetis \</div>
<div class="line">    --download-superlu_dist</div>
<div class="line">make all</div>
<div class="line">make test</div>
</div><!-- fragment --><p >When running the code on an external cluster, make sure that you compile PETSc with the MPI that has been configured to work with the cluster. Hence, <b>do not use the <code>--download-openmpi</code> flag</b>, but instead point to the folder with the MPI compilers and executables using the <code>--with-mpi-dir</code> flag. If BLAS and LAPACK are already installed in the system, you can point to the libraries using the <code>--with-blas-lib</code> and <code>--with-lapack-lib</code> flags.</p>
<p ><a href="http://www.mcs.anl.gov/petsc/documentation/installation.html">Detailed instructions</a> with more options to customize your installation can be found on the PETSc website. Run <code>./configure --help</code> in the PETSc root directory to list all the available configure flags.</p>
<p >The PETSc Users Manual and the Manual Pages can be found on their <a href="http://www.mcs.anl.gov/petsc/documentation/index.html">documentation page</a>.</p>
<hr  />
<h1>yaml-cpp</h1>
<p ><a href="https://github.com/jbeder/yaml-cpp">yaml-cpp</a> is a <a class="el" href="../../d7/d1e/namespace_y_a_m_l.html">YAML</a> parser in C++, used in PetIBM to parse the input configuration file.</p>
<p >The PetIBM configuration script gives the possibility to use a previously installed version of yaml-cpp (with the configuration argument <code>--with-yamlcpp-dir=&lt;path&gt;</code>, or <code>--with-yamlcpp-include=&lt;path&gt;</code> and <code>--with-yamlcpp-lib=&lt;path&gt;</code>) or to download and install yaml-cpp-0.6.2 (with <code>--enable-yamlcpp</code>).</p>
<hr  />
<h1>gtest</h1>
<p >We use Google's C++ test framework <a href="https://github.com/google/googletest">gtest</a> to run unit-tests after compiling PetIBM. When configuring PetIBM, you can either use a previously installed version of gtest and provide the path of the directory of the gtest installation with <code>--with-gtest-dir=&lt;path&gt;</code> (or using <code>--with-gtest-include=&lt;path&gt;</code> and <code>--with-gtest-lib=&lt;path&gt;</code>) or request to download and install gtest-1.7.0 with <code>--enable-gtest</code>.</p>
<hr  />
<h1>PetIBM</h1>
<p >Create a local copy of the PetIBM repository:</p>
<div class="fragment"><div class="line">cd $HOME/sfw</div>
<div class="line">mkdir petibm &amp;&amp; cd petibm</div>
<div class="line">git clone https://github.com/barbagroup/PetIBM.git</div>
<div class="line">export PETIBM_DIR=$HOME/sfw/petibm/PetIBM</div>
</div><!-- fragment --><p >You can set the environment variable <code>PETIBM_DIR</code> to your <code>$HOME/.bashrc</code> or <code>$HOME/.bash_profile</code> files by adding the line:</p>
<div class="fragment"><div class="line">export PETIBM_DIR=$HOME/sfw/petibm/PetIBM</div>
</div><!-- fragment --><p >and restart you terminal or source the file:</p>
<div class="fragment"><div class="line">source $HOME/.bashrc</div>
</div><!-- fragment --><p >Note: if you are using C shell, use the <code>setenv</code> command instead of <code>export</code>.</p>
<p >Configure and build PetIBM with PETSc in debugging mode:</p>
<div class="fragment"><div class="line">PETSC_DIR=$HOME/sfw/petsc/3.11.3</div>
<div class="line">PETSC_ARCH=linux-dbg</div>
<div class="line">mkdir petibm-linux-dbg &amp;&amp; cd petibm-linux-dbg</div>
<div class="line">$PETIBM_DIR/configure \</div>
<div class="line">    --prefix=$HOME/sfw/petibm/petibm-linux-dbg \</div>
<div class="line">    CXX=$PETSC_DIR/$PETSC_ARCH/bin/mpicxx \</div>
<div class="line">    CXXFLAGS=&quot;-g -O0 -Wall -Wno-deprecated -std=c++14&quot; \</div>
<div class="line">    --with-petsc-dir=$PETSC_DIR \</div>
<div class="line">    --with-petsc-arch=$PETSC_ARCH \</div>
<div class="line">    --with-yamlcpp-dir=&lt;path&gt; \</div>
<div class="line">    --with-gtest-dir=&lt;path&gt;</div>
<div class="line">make all</div>
<div class="line">make check</div>
<div class="line">make install</div>
</div><!-- fragment --><p >If yaml-cpp and/or gtest are not available, you can request installation at configuration time using:</p>
<div class="fragment"><div class="line">$PETIBM_DIR/configure \</div>
<div class="line">    --prefix=$HOME/sfw/petibm/petibm-linux-dbg \</div>
<div class="line">    CXX=$PETSC_DIR/$PETSC_ARCH/bin/mpicxx \</div>
<div class="line">    CXXFLAGS=&quot;-g -O0 -Wall -Wno-deprecated -std=c++14&quot; \</div>
<div class="line">    --enable-yamlcpp \</div>
<div class="line">    --enable-gtest</div>
</div><!-- fragment --><p >For production runs, you may want to use the optimized build of PETSc:</p>
<div class="fragment"><div class="line">PETSC_DIR=$HOME/sfw/petsc/3.11.3</div>
<div class="line">PETSC_ARCH=linux-opt</div>
<div class="line">mkdir petibm-linux-opt &amp;&amp; cd petibm-linux-opt</div>
<div class="line">$PETIBM_DIR/configure \</div>
<div class="line">    --prefix=$HOME/sfw/petibm/petibm-linux-opt \</div>
<div class="line">    CXX=$PETSC_DIR/$PETSC_ARCH/bin/mpicxx \</div>
<div class="line">    CXXFLAGS=&quot;-O3 -Wall -Wno-deprecated -std=c++14&quot; \</div>
<div class="line">    --with-petsc-dir=$PETSC_DIR \</div>
<div class="line">    --with-petsc-arch=$PETSC_ARCH \</div>
<div class="line">    --with-yamlcpp-dir=&lt;path&gt; \</div>
<div class="line">    --with-gtest-dir=&lt;path&gt;</div>
<div class="line">make all</div>
<div class="line">make check</div>
<div class="line">make install</div>
</div><!-- fragment --><p >Et voila! You can now add the <code>bin</code> directory (that contains the executables) to you PATH environment variable:</p>
<div class="fragment"><div class="line">export PATH=$HOME/sfw/petibm/petibm-linux-opt/bin:$PATH</div>
</div><!-- fragment --><hr  />
<h1>PetIBM examples</h1>
<p >We provide some examples! Input files are located in <code>$PETIBM_DIR</code>, but can be copied to another directory with</p>
<div class="fragment"><div class="line">make copy-examples EXAMPLES_DIR=&lt;directory&gt;</div>
</div><!-- fragment --><p ><code>EXAMPLES_DIR</code> is optional and the default directory is the folder <code>examples</code> in the top build directory.</p>
<hr  />
<h1>Optional: using NVIDIA AmgX to solve linear systems on multiple GPUs</h1>
<p >PetIBM implements the possibility to solve linear systems on CUDA-capable GPU devices using the NVIDIA <a href="https://github.com/NVIDIA/AMGX">AmgX</a> library.</p>
<p >To solve linear systems on multiple GPU devices with PetIBM, the user must install CUDA and AmgX before building PetIBM and use the configuration arguments <code>--with-cuda-dir=&lt;path&gt;</code> for CUDA and <code>--with-amgx-dir=&lt;path&gt;</code> (or <code>--with-amgx-include=&lt;path&gt;</code> and <code>--with-amgx-lib=&lt;path&gt;</code>) for AmgX.</p>
<p >To handle the data conversion between PETSc and AmgX, we use our in-house wrapper, called <a href="https://github.com/barbagroup/AmgXWrapper">AmgXWrapper</a>. When configuring PetIBM, you can either use a previously installed version of AmgXWrapper and provide the path of the directory of the AmgXWrapper installation with <code>--with-amgxwrapper-dir=&lt;path&gt;</code> (or using <code>--with-amgxwrapper-include=&lt;path&gt;</code> and <code>--with-amgxwrapper-lib=&lt;path&gt;</code>) or request to download and install AmgXWrapper-1.4 with <code>--enable-amgxwrapper</code>.</p>
<p >For example, to build an optimized version of PetIBM with CUDA, AmgX, and AmgXWrapper:</p>
<div class="fragment"><div class="line">PETSC_DIR=$HOME/sfw/petsc/3.11.3</div>
<div class="line">PETSC_ARCH=linux-opt</div>
<div class="line">mkdir petibm-linux-opt &amp;&amp; cd petibm-linux-opt</div>
<div class="line">$PETIBM_DIR/configure \</div>
<div class="line">    --prefix=$HOME/sfw/petibm/petibm-linux-opt \</div>
<div class="line">    CXX=$PETSC_DIR/$PETSC_ARCH/bin/mpicxx \</div>
<div class="line">    CXXFLAGS=&quot;-O3 -Wall -Wno-deprecated -std=c++14&quot; \</div>
<div class="line">    --with-petsc-dir=$PETSC_DIR \</div>
<div class="line">    --with-petsc-arch=$PETSC_ARCH \</div>
<div class="line">    --with-yamlcpp-dir=&lt;path&gt; \</div>
<div class="line">    --with-gtest-dir=&lt;path&gt; \</div>
<div class="line">    --with-cuda-dir=&lt;path&gt; \</div>
<div class="line">    --with-amgx-dir=&lt;path&gt; \</div>
<div class="line">    --with-amgxwrapper-dir=&lt;path&gt;</div>
<div class="line">make all</div>
<div class="line">make check</div>
<div class="line">make install</div>
</div><!-- fragment --><hr  />
<h1>Contributing and reporting bugs</h1>
<p >To report bugs, please use the GitHub issue tracking system. We are also open to pull-requests. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Mar 17 2022 18:28:00 for PetIBM by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
