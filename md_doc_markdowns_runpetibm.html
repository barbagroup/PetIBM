<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>PetIBM: Run PetIBM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PetIBM
   &#160;<span id="projectnumber">0.5</span>
   </div>
   <div id="projectbrief">Toolbox and applications of the immersed-boundary method for distributed-memory architectures</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="md_CHANGELOG.html"><span>Change&#160;Log</span></a></li>
      <li><a href="md_CONTRIBUTING.html"><span>Contributing</span></a></li>
      <li><a href="usergroup0.html"><span>Quick&#160;Start</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_doc_markdowns_runpetibm.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Run PetIBM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>PetIBM is a library (a toolbox to solve the Navier-Stokes equations with an immersed-boundary method) that comes with several application codes. Upon successful installation, the library (shared and/or static) and the application programs should be respectively located in the <code>lib</code> and <code>bin</code> folders of your installation directory.</p>
<p>Once PetIBM is installed, the libraries (shared and/or static) are located in the <code>lib</code> folder of your installation directory. The present software package comes with 5 application codes that use the PetIBM library. Upon successful installation, the binary executables for these applications are located in the <code>bin</code> folder of your installation directory. For convenience, you can prepend your PATH environment variable with the <code>bin</code> directory to use the binary executables: </p><pre class="fragment">export PATH=&lt;petibm-installation-directory&gt;/bin:$PATH
</pre><p>List of binary executables:</p><ul>
<li><code>petibm-navierstokes</code></li>
<li><code>petibm-ibpm</code></li>
<li><code>petibm-decoupledibpm</code></li>
<li><code>petibm-writemesh</code></li>
<li><code>petibm-vorticity</code></li>
<li><code>petibm-createxdmf</code></li>
</ul>
<p>These programs work for 2D <b>and</b> 3D configurations and can be run in serial or parallel (with <code>mpiexec</code> or <code>mpirun</code>). The following sub-sections provide more details about each executable.</p>
<h2>Program <code>petibm-navierstokes</code></h2>
<p>The program solves the 2D or 3D Navier-Stokes equations using a projection method: an approximate block-LU decomposition (Perot, 1993). The equations are fully discretized in space (second-order central differences) and in time. At each time step, the program solves a system for the velocity field and then a Poisson system for the pressure to project the velocity onto the space of divergence-free fields.</p>
<p>To run the program: </p><pre class="fragment">cd &lt;simulation-directory&gt;
petibm-navierstokes
</pre><p>In the current working directory differs from the simulation directory, provide the path of the simulation directory: </p><pre class="fragment">petibm-navierstokes -directory &lt;simulation-directory&gt;
</pre><p>If the <a class="el" href="d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file in not located in the simulation directory: </p><pre class="fragment">petibm-navierstokes -config &lt;config-path&gt;
</pre><p>To run on two CPU processes: </p><pre class="fragment">mpiexec -np 2 petibm-navierstokes
</pre><h2>Program <code>petibm-ibpm</code></h2>
<p>The program solves the 2D and 3D Navier-Stokes equations with an immersed-boundary method: the Immersed Boundary Projection Method (IBPM) proposed by Taira and Colonius (2007). The method is based on the projection approach of Perot (1993) and is suitable to solve the flow around one or several, fixed or moving, rigid immersed boundaries. Note that the current implementation of the method in PetIBM only works for fixed immersed boundaries. At each time step, the program solves a system for the velocity field and then a modified Poisson system for the pressure field and Lagrangian forces. Finally, the velocity field is projected onto the space of divergence-free fields that satisfy the no-slip condition at the location of the Lagrangian boundary points.</p>
<p>To run a simulation with the IBPM: </p><pre class="fragment">cd &lt;simulation-directory&gt;
mpiexec -np n petibm-ibpm
</pre><p>You can also provide the path of the simulation directory with the command-line argument <code>-directory &lt;path&gt;</code> and/or the path of the <a class="el" href="d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file with <code>-config &lt;path&gt;</code>.</p>
<h2>Program <code>petibm-decoupledibpm</code></h2>
<p>The program solves the 2D and 3D Navier-Stokes equations with an immersed-boundary method: a decoupled version of the Immersed Boundary Projection Method proposed by Li et al. (2016). The method extends from the work of Taira and Colonius (2007) and decouples the pressure field from the Lagrangian boundary forces. Three linear systems are solved every time step: a system for the velocity field, a Poisson system for the pressure field, and a system for the Lagrangian forces. The divergence-free and the no-slip constraints are imposed in a sequential fashion.</p>
<p>To run a simulation with a decoupled version of the IBPM: </p><pre class="fragment">cd &lt;simulation-directory&gt;
mpiexec -np n petibm-decoupledibpm
</pre><p>You can also provide the path of the simulation directory with the command-line argument <code>-directory &lt;path&gt;</code> and/or the path of the <a class="el" href="d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file with <code>-config &lt;path&gt;</code>.</p>
<h2>Program <code>petibm-writemesh</code></h2>
<p>This program is a simple (and optional) pre-processing utility that creates a structured Cartesian mesh based on the configuration provided in a given <a class="el" href="d7/d1e/namespace_y_a_m_l.html">YAML</a> file. The gridline coordinates are then written into a HDF5 file (<code>grid.h5</code>) saved in the simulation directory.</p>
<h2>Program <code>petibm-vorticity</code></h2>
<p>This program is a post-processing utility to compute the vorticity vector field from the velocity vector field; it works for 2D and 3D configurations.</p>
<p>In 2D, <code>petibm-vorticity</code>:</p><ul>
<li>reads the grids for the x- and y-components of the velocity field (group names <code>u</code> and <code>v</code> in the file <code>grid.h5</code>),</li>
<li>computes the grid of the vorticity scalar field,</li>
<li>writes the vorticity grid in <code>grid.h5</code> (group name <code>wz</code>),</li>
<li>for each saved time step:<ul>
<li>reads the x- and y-components of the velocity field (group names <code>u</code> and <code>v</code> in the HDF5 solution file),</li>
<li>computes the vorticity scalar field,</li>
<li>writes the vorticity values in the HDF5 solution field (group name <code>wz</code>).</li>
</ul>
</li>
</ul>
<p>In 3D, <code>petibm-vorticity</code>:</p><ul>
<li>reads the grids for the x-, y- and z-components of the velocity field (group names <code>u</code>, <code>v</code>, and <code>w</code> in the file <code>grid.h5</code>),</li>
<li>computes the grid for each component of the vorticity vector field,</li>
<li>writes the vorticity grids in <code>grid.h5</code> (group name <code>wx</code>, <code>wy</code>, and <code>wz</code>),</li>
<li>for each saved time step:<ul>
<li>reads the x-, y-, and z-components of the velocity field (group names <code>u</code>, <code>v</code>, and <code>w</code> in the HDF5 solution file),</li>
<li>computes the vorticity vector field,</li>
<li>writes the vorticity values in the HDF5 solution field (group names <code>wx</code>, <code>wy</code>, and <code>wz</code>).</li>
</ul>
</li>
</ul>
<p>To compute the vorticity field: </p><pre class="fragment">cd &lt;simulation-directory&gt;
mpiexec -np n petibm-vorticity
</pre><p>You can also provide the path of the simulation directory with the command-line argument <code>-directory &lt;path&gt;</code> and/or the path of the <a class="el" href="d7/d1e/namespace_y_a_m_l.html">YAML</a> configuration file with <code>-config &lt;path&gt;</code>.</p>
<h2>Program <code>petibm-createxdmf</code></h2>
<p>This program is a post-processing utility which creates XDMF files for the solution variables which can be used to visualize and process HDF5 fields with <a href="https://wci.llnl.gov/simulation/computer-codes/visit/">VisIt</a> (versions 2.12.3 and 2.13.1 have been tested) or <a href="https://www.paraview.org/">ParaView</a> (versions 5.4.1 and 5.5.0 have been tested). The utility works for 2D and 3D configurations.</p>
<p>To create XDMF files: </p><pre class="fragment">petibm-createxdmf
</pre><p>It will create XDMF files for the pressure (<code>p.xmf</code>), the velocity components (<code>u.xmf</code> and <code>v.xmf</code> for 2D configurations;<code>u.xmf</code>, <code>v.xmf</code>, and <code>w.xmf</code> for 3D configurations), and the vorticity components (<code>wz.xmf</code> for 2D configurations; <code>wx.xmf</code>, <code>wy.xmf</code>, and <code>wz.xmf</code> for 3D configurations).</p>
<h2>Running PetIBM using NVIDIA AmgX</h2>
<p>To solve one or several linear systems on CUDA-capable GPU devices, PetIBM calls the <a href="https://github.com/NVIDIA/AMGX">NVIDIA AmgX</a> library. Solving on GPU devices is supported in the programs <code>petibm-navierstokes</code>, <code>petibm-ibpm</code>, <code>petibm-decoupledibpm</code>.</p>
<p>For example to run a simulation using 2 MPI processes and 2 GPU devices, simply use: </p><pre class="fragment">mpiexec -np 2 &lt;petibm-executable&gt;
</pre><p>If you choose to run on 4 MPI processes but only using 2 GPU devices: </p><pre class="fragment">export CUDA_VISIBLE_DEVICES=0,1
mpiexec -np 4 &lt;petibm-executable&gt;
</pre><h2>References</h2>
<ul>
<li>Li, R. Y., Xie, C. M., Huang, W. X., &amp; Xu, C. X. (2016). An efficient immersed boundary projection method for flow over complex/moving boundaries. Computers &amp; Fluids, 140, 122-135.</li>
<li>Perot, J. B. (1993). An analysis of the fractional step method. Journal of Computational Physics, 108(1), 51-58.</li>
<li>Taira, K., &amp; Colonius, T. (2007). The immersed boundary method: a projection approach. Journal of Computational Physics, 225(2), 2118-2137. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Dec 11 2019 16:43:05 for PetIBM by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
